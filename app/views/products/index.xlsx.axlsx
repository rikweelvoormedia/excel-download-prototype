wb = xlsx_package.workbook
wb.add_worksheet(name: "Products") do |sheet|
  sheet.add_row ['priority', 'Title', 'Price', 'Department', 'Material']
  @products.each do |product|
    sheet.add_row [{0 => "high", 1 => "medium", 2 => "low"}[rand(3)], product.title, product.price, product.department, product.material]
  end
  sheet.auto_filter = "A1:E31"
  sheet.auto_filter.sort_state.add_sort_condition(4)
  # commented for a test
end
